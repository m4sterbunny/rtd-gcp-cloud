
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Virtual Private Cloud &#8212; Cloud Notes 0.1 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Review Questions Billing &amp; Accounts" href="accounts-billing-quiz.html" />
    <link rel="prev" title="Virtual Machines" href="VMs.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="virtual-private-cloud">
<h1>Virtual Private Cloud<a class="headerlink" href="#virtual-private-cloud" title="Permalink to this headline">¶</a></h1>
<p>GCP’s Virtual Private Cloud (VPC) supports networking with VM instances, Kubernetes Engine containers, and the App Engine flexible environment. A VPC network is an essential component of linking with VM instances, containers, or App Engine applications. Therefore, each GCP project creates a default network a soon as any of these services are started.</p>
<p>The GCP supports 3 different Virtual Private Cloud (VPC) network types:</p>
<ul class="simple">
<li><p>Default</p></li>
<li><p>Auto mode</p></li>
<li><p>Custom mode</p></li>
</ul>
<p>The default setup has one subnet per region and pre-set firewall rules. The Auto mode option includes regional IP allocation and a fixed /20 subnet per region, it comes with one subnet per region. The custom mode does not setup default subnets, it allows full control of IP ranges as well as regional IP allocation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Auto mode networks</p>
<p>Auto mode networks may be upgraded to Custom mode, but this can not be reverted.</p>
<p>They include routes, subnets, and firewall rules.</p>
<p>They are not recommended for production environments. The IP ranges are assigned for you.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ping -c <span class="m">3</span> <span class="nv">$IP</span>-Address
</pre></div>
</div>
<p>Expect positive ping results for internal IPs only if the instance exists on the same network.</p>
<p>Expect positive ping results for external IPs only if you have a firewall rule that allows ICMP incoming.</p>
</div>
<p>You can connect using internal IP addresses from different network by using options such as VPC peering.</p>
<div class="section" id="networks">
<h2>Networks<a class="headerlink" href="#networks" title="Permalink to this headline">¶</a></h2>
<p>Networks allow you to isolate systems. Different VMs, for example may exist on different networks. VMs on the same network can communicate using their internal IPs (which are actually mapped by DNS), even if they are in different regions. You can ping a VM instance by its name, for example, because VPC networks have an internal DNS service that allows you to address instances by their DNS names rather than their internal IP addresses. This is a very useful feature, because the internal IP address can change when you delete and re-create an instance.</p>
<p>Conversely, even if VMs are in the same region, if they are on different networks they must use their external IPs to communicate.</p>
<p>VPC networks function as a distributed firewall, with the firewall rules enforced across the entire network unless set to a specific instance only.</p>
<p>To view your firewall rules use:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gcloud compute firewall-rules list --sort-by<span class="o">=</span>NETWORK
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="vpn-networking">
<h2>VPN Networking<a class="headerlink" href="#vpn-networking" title="Permalink to this headline">¶</a></h2>
<p>By leveraging VPN networks it becomes possible to connect VMs in different zones with subnets. A single firewall rule can apply to all VMs on that subnet, even though they are in different zones.</p>
<div class="section" id="subnets">
<h3>Subnets<a class="headerlink" href="#subnets" title="Permalink to this headline">¶</a></h3>
<p>Every subnet has 4 reserved IP addresses, the first 2 are assigned to the network and the subnet’s gateway. The final 2 addresses are also reserved, with the last being used as the broadcast address.</p>
<p>Overly-large subnets can cause conflicts, be cautious and do not scale a subnet beyond current usage needs.</p>
<p>To create a subnet from the cloud shell cli:</p>
<p>To create a custom network:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gcloud compute networks create mynet --subnet-mode<span class="o">=</span>custom
</pre></div>
</div>
</div></blockquote>
<p>To create a custom subnet:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gcloud compute networks subnets create privatesubnet-us --network<span class="o">=</span>privatenet --region<span class="o">=</span>us-central1 --range<span class="o">=</span><span class="m">172</span>.16.0.0/24
</pre></div>
</div>
</div></blockquote>
<p>To view your networks:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gcloud compute networks list
</pre></div>
</div>
</div></blockquote>
<p>To create a custom network:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gcloud compute networks create <span class="nv">$my</span>-net1 --subnet-mode<span class="o">=</span>custom
</pre></div>
</div>
</div></blockquote>
<p>To provide this network with firewall rules:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gcloud compute firewall-rules create <span class="nv">$my</span>-firewall-custom1
--network my-net1
--allow<span class="o">=</span> tcp, udp, icmp
-- <span class="nv">source</span><span class="o">=</span>ranges <span class="nv">$IP</span>-range


gcloud compute firewall-rules create <span class="nv">$my</span>-firewall-custom2
--network my-net1
--allow<span class="o">=</span> tcp:22, tcp:3389, icmp
</pre></div>
</div>
</div></blockquote>
<p>But remember a network is just a collection of subnets. Now you have a network name to group them by, use:</p>
<p>To create a subnet:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gcloud compute networks create <span class="nv">$manage</span>-subnets --region<span class="o">=</span>us-central1 --range<span class="o">=</span><span class="m">10</span>.130.0.0/20
</pre></div>
</div>
</div></blockquote>
<p>To create a 2nd subnet:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gcloud compute networks create <span class="nv">$manage</span>-subnets --region<span class="o">=</span>us-central1 --range<span class="o">=</span><span class="m">10</span>.130.0.0/20
</pre></div>
</div>
</div></blockquote>
<p>To view these networks:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gcloud compute networks list
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="instance-isolation">
<h2>Instance Isolation<a class="headerlink" href="#instance-isolation" title="Permalink to this headline">¶</a></h2>
<p>A bastion host acts to isolate an instance for you.</p>
<img alt="../_images/bastion-host.PNG" src="../_images/bastion-host.PNG" />
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Cloud Notes</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="api.html">A World of API</a></li>
<li class="toctree-l1"><a class="reference internal" href="accounts-billing.html">Accounts &amp; Billing</a></li>
<li class="toctree-l1"><a class="reference internal" href="cloud-shell.html">Cloud Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="kubernetes.html">Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="stackdriver.html">Stackdriver</a></li>
<li class="toctree-l1"><a class="reference internal" href="VMs.html">Virtual Machines</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Virtual Private Cloud</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#networks">Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vpn-networking">VPN Networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="#instance-isolation">Instance Isolation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="accounts-billing-quiz.html">Review Questions Billing &amp; Accounts</a></li>
<li class="toctree-l1"><a class="reference internal" href="accounts-billing-quiz.html#answers-billing-accounts">Answers Billing &amp; Accounts</a></li>
<li class="toctree-l1"><a class="reference internal" href="storage.html">Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="ace-exam.html">ACE</a></li>
<li class="toctree-l1"><a class="reference internal" href="react-app.html">Set Up a Ubuntu Environment on GCP</a></li>
<li class="toctree-l1"><a class="reference internal" href="react-app.html#upload-your-lottie-to-your-vm">3.0 Upload your Lottie to your VM</a></li>
<li class="toctree-l1"><a class="reference internal" href="react-app.html#customize-your-app-with-a-lottie">Customize Your App with a Lottie</a></li>
<li class="toctree-l1"><a class="reference internal" href="release-7-2-0.html">ADS GEO Reference Documentation Version 7.2.0</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="VMs.html" title="previous chapter">Virtual Machines</a></li>
      <li>Next: <a href="accounts-billing-quiz.html" title="next chapter">Review Questions Billing &amp; Accounts</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, masterbunny.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="../_sources/pages/virtual-networking.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>